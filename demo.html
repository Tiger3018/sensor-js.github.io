<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Demo - The Web's Sixth Sense: A Study of Scripts Accessing Smartphone Sensors</title>
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <title>Sensor Access Demo</title>
    <style>
      p {margin-bottom: 0.3rem;}
    </style>
</head>
<body>
<main role="main" class="container">

<h1 align="left">Sensor Access Demo</h1>

<p>This is a demo page showcasing how websites can access sensor data from mobile devices.</p>

<p>Two sensor events supported by all modern browsers are
<a href="https://developer.mozilla.org/en-US/docs/Web/Events/devicemotion"><i>deviceorientation</i></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/Events/deviceorientation"><i>devicemotion</i></a>. <i>deviceorientation</i> provides <i>alpha</i>, <i>beta</i> and <i>gamma</i> components which correspond to orientation along the Z, X and Y axes, respectively. <i>devicemotion</i> provides acceleration and rotation rate along three axes using MEMS accelerometers and gyroscopes.</p>

<p>The sensor data shown below does not leave your browser: it is not collected, shared or transmitted. However this may not be true for other websites that you visit. See the companion web page for the ACM CCS'18 paper <a href="https://sensor-js.xyz/">"The Web's Sixth Sense: A Study of Scripts Accessing Smartphone Sensors"</a> for more information.</p>

<div class="p-3 mb-2 bg-secondary text-white" id="demo-div">
<a id="start_demo" class="btn btn-lg btn-success" href="#demo-div" role="button">Start the demo</a>

<h3 style="margin-top:1rem;">Orientation</h3>
<ul>
  <li>X-axis (&beta;): <span id="Orientation_b">?</span></li>
  <li>Y-axis (&gamma;): <span id="Orientation_g">?</span></li>
  <li>Z-axis (&alpha;): <span id="Orientation_a">?</span></li>
</ul>

<h3>Accelerometer</h3>
<ul>
  <li>X-axis: <span id="Accelerometer_x">?</span></li>
  <li>Y-axis: <span id="Accelerometer_y">?</span></li>
  <li>Z-axis: <span id="Accelerometer_z">?</span></li>
  <li>Data Interval: <span id="Accelerometer_i">?</span></li>
</ul>

<h3>Accelerometer including gravity</h3>

<ul>
  <li>X-axis: <span id="Accelerometer_gx">?</span></li>
  <li>Y-axis: <span id="Accelerometer_gy">?</span></li>
  <li>Z-axis: <span id="Accelerometer_gz">?</span></li>
</ul>

<h3>Gyroscope</h3>
<ul>
  <li>X-axis: <span id="Gyroscope_x">?</span></li>
  <li>Y-axis: <span id="Gyroscope_y">?</span></li>
  <li>Z-axis: <span id="Gyroscope_z">?</span></li>
</ul>

</div>
</main>
<footer class="footer">
  <div class="container">
    <span class="text-muted small">This page is hosted on GitHub Pages, please see GitHub's privacy statement
    <a href="https://help.github.com/articles/github-privacy-statement/">here</a>.</span>
  </div>
</footer>
<script>

function handleOrientation(event) {
  updateFieldIfNotNull('Orientation_a', event.alpha);
  updateFieldIfNotNull('Orientation_b', event.beta);
  updateFieldIfNotNull('Orientation_g', event.gamma);
}

function updateFieldIfNotNull(fieldName, value, precision=10){
  if (value != null)
    document.getElementById(fieldName).innerHTML = value.toFixed(precision);
}

function handleMotion(event) {
  updateFieldIfNotNull('Accelerometer_gx', event.accelerationIncludingGravity.x);
  updateFieldIfNotNull('Accelerometer_gy', event.accelerationIncludingGravity.y);
  updateFieldIfNotNull('Accelerometer_gz', event.accelerationIncludingGravity.z);

  updateFieldIfNotNull('Accelerometer_x', event.acceleration.x);
  updateFieldIfNotNull('Accelerometer_y', event.acceleration.y);
  updateFieldIfNotNull('Accelerometer_z', event.acceleration.z);

  updateFieldIfNotNull('Accelerometer_i', event.interval, 2);

  updateFieldIfNotNull('Gyroscope_z', event.rotationRate.alpha);
  updateFieldIfNotNull('Gyroscope_x', event.rotationRate.beta);
  updateFieldIfNotNull('Gyroscope_y', event.rotationRate.gamma);

}

let is_running = false;
let demo_button = document.getElementById("start_demo");
demo_button.onclick = function() {
  if (is_running){
    window.removeEventListener("devicemotion", handleMotion);
    window.removeEventListener("deviceorientation", handleOrientation);
    demo_button.innerHTML = "Start the demo";
    demo_button.classList.add('btn-success');
    demo_button.classList.remove('btn-danger');
    is_running = false;
  }else{
    window.addEventListener("devicemotion", handleMotion);
    window.addEventListener("deviceorientation", handleOrientation);
    document.getElementById("start_demo").innerHTML = "Stop the demo";
    demo_button.classList.remove('btn-success');
    demo_button.classList.add('btn-danger');
    is_running = true;
  }
};

/*
Light and proximity are not supported anymore by mainstream browsers.
window.addEventListener('devicelight', function(e) {
   document.getElementById("DeviceLight").innerHTML="AmbientLight current Value: "+e.value+" Max: "+e.max+" Min: "+e.min;
});

window.addEventListener('lightlevel', function(e) {
   document.getElementById("Lightlevel").innerHTML="Light level: "+e.value;
});

window.addEventListener('deviceproximity', function(e) {
   document.getElementById("DeviceProximity").innerHTML="DeviceProximity current Value: "+e.value+" Max: "+e.max+" Min: "+e.min;
});

window.addEventListener('userproximity', function(event) {
   document.getElementById("UserProximity").innerHTML="UserProximity: "+event.near;
});
*/

</script>
</body>
</html>
